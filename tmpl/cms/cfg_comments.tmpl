<mt:setvar name="page_title" value="<__trans phrase="Comment Settings">">
<mt:setvar name="comments" value="1">
<MTSetVarBlock name="content_header">

    <mt:if name="error">
        <mtapp:statusmsg
            id="generic-error"
            class="error">
            <mt:var name="error">
        </mtapp:statusmsg>
    </mt:if>

    <mt:if name="saved">
        <mt:if name="can_rebuild">
            <mt:if name="need_full_rebuild">
                <mtapp:statusmsg
                    id="saved-full-rebuild"
                    class="success"
                    rebuild="all">
                    <__trans phrase="Your preferences have been saved.">
                </mtapp:statusmsg>
            <mt:else>
                <mt:if name="need_index_rebuild">
                    <mtapp:statusmsg
                        id="saved-index-rebuild"
                        class="success"
                        rebuild="index">
                        <__trans phrase="Your preferences have been saved.">
                    </mtapp:statusmsg>
                <mtelse>
                    <mtapp:statusmsg
                        id="saved"
                        class="success">
                        <__trans phrase="Your preferences have been saved.">
                    </mtapp:statusmsg>
                </mt:if>
            <mtelse>
                <mtapp:statusmsg
                    id="saved"
                    class="success">
                    <__trans phrase="Your preferences have been saved.">
                </mtapp:statusmsg>
            </mt:if>
        <mtelse>
            <mtapp:statusmsg
                id="saved"
                class="success">
                <__trans phrase="Your preferences have been saved.">
            </mtapp:statusmsg> 
        </mtif> 
    </mt:if>

</MTSetVarBlock>
<MTSetVarBlock name="content_nav">
    <mt:include name="include/cfg_content_nav.tmpl">
</MTSetVarBlock>
<mt:include name="include/header.tmpl">


<form name="cfg_form" method="post" action="<mt:var name="script_url">">
<input type="hidden" name="id" value="<mt:var name="id">" />
<input type="hidden" name="__mode" value="save" />
<input type="hidden" name="_type" value="blog" />
<input type="hidden" name="cfg_screen" value="cfg_comments" />
<input type="hidden" name="blog_id" value="<mt:var name="blog_id">" />
<input type="hidden" name="return_args" value="<mt:var name="return_args" escape="html">" />
<input type="hidden" name="magic_token" value="<mt:var name="magic_token">" />

<fieldset>

<mt:unless name="system_allow_comments">
    <mtapp:statusmsg
        id="system-allow-comments"
        class="alert">
        <__trans phrase="Note: Commenting is currently disabled at the system level.">
    </mtapp:statusmsg>
</mt:unless>

<mt:unless name="tk_available">
<p><__trans phrase="Comment authentication is not available because one of the needed modules, MIME::Base64 or LWP::UserAgent is not installed. Talk to your host about getting this module installed."></p>
</mt:unless>

    <mtapp:setting
        id="allow_comments"
        label="<__trans phrase="Accept Comments">"
        help_page="blog_settings_feedback"
        help_section="accept_comments_from">
<input type="checkbox" name="allow_comments" value="1" id="allow_comments" onclick="toggleSubPrefs(this); return true"<mt:if name="allow_comments"> checked="checked"</mt:if> class="cb" /> <__trans phrase="If enabled, comments will be accepted.">
    </mtapp:setting>

<div id="allow_comments_prefs" style="display:<mt:if name="allow_comments">block<mt:else>none</mt:if>">

<h3><__trans phrase="Commenting Policy"></h3>

    <mtapp:setting
        id="setting-auth-status"
        label="<__trans phrase="Allowed Authentication Methods">">
<mt:unless name="commenter_authenticators"><mt:if name="allow_reg_comments"><mt:unless name="allow_unreg_comments">
<p>
<img src="<mt:var name="static_uri">images/status_icons/warning.gif" alt="<__trans phrase="Authentication Not Enabled">" width="9" height="9" />
<span class="alert-warning-inline"><__trans phrase="Note: You have selected to accept comments from authenticated commenters only but authentication is not enabled. In order to receive authenticated comments, you must enable authentication."></span>
</p>
</mt:unless></mt:if></mt:unless>
<mt:include name="include/anonymous_comment.tmpl">

<p><input type="checkbox" name="enabled_MovableType" value="1"<mt:if name="enabled_MovableType"> checked="checked"</mt:if> /> Movable Type <__trans phrase="Native"></p>

<mt:if name="cmtauth_loop">
<mt:loop name="cmtauth_loop">
<mt:if name="key" eq="TypeKey">
<mt:setvar name="typekey_enabled" value="1">
<p><input type="checkbox" id="enabled_<mt:var name="key">" name="enabled_<mt:var name="key">" value="1" onclick="toggleSubPrefs(this); return true"<mt:if name="enabled"> checked="checked"</mt:if><mt:if name="disabled"> disabled="disabled"</mt:if> /> <label for="enabled_<mt:var name="key">"><mt:var name="label"></label></p>
<div id="enabled_TypeKey_prefs" style="display:<mt:if name="enabled">block<mt:else>none</mt:if>">
  <p style="margin-left: 25px;"><input type="checkbox" value="1" id="require_typekey_emails" name="require_typekey_emails"<mt:if name="require_typekey_emails"> checked="checked"</mt:if> class="cb" />&nbsp;<__trans phrase="Require E-mail Address for Comments via TypeKey"><br />
  <span class="hint"><__trans phrase="If enabled, visitors must allow their TypeKey account to share e-mail address when commenting."></span>
  <a href="javascript:void(0)" onclick="return openManual('blog_settings_feedback', 'require_email_address')" class="help-link">?</a></p>
</div>
<mt:else>
<p><input type="checkbox" id="enabled_<mt:var name="key">" name="enabled_<mt:var name="key">" value="1"<mt:if name="enabled"> checked="checked"</mt:if><mt:if name="disabled"> disabled="disabled"</mt:if> /> <label for="enabled_<mt:var name="key">"><mt:var name="label"></label></p>
</mt:if>
</mt:loop>
</mt:if>

<mt:unless name="typekey_enabled">
<p><a href="<mt:var name="script_url">?__mode=cfg_web_services&amp;blog_id=<mt:var name="blog_id">"><__trans phrase="Setup other authentication services"></a></p>
</mt:unless>
<mt:unless name="openid_enabled">
<p>
<img src="<mt:var name="static_uri">images/status_icons/warning.gif" alt="<__trans phrase="OpenID providers disabled">" width="9" height="9" />
<span class="alert-warning-inline"><__trans phrase="Required module (Digest::SHA1) for OpenID commenter authentication is missing."></span>
</p>
</mt:unless>
    </mtapp:setting>

    <mtapp:setting
        id="moderate_comments"
        label="<__trans phrase="Immediately approve comments from">"
        hint="<__trans phrase="Specify what should happen to comments after submission. Unapproved comments are held for moderation.">"
        help_page="blog_settings_feedback"
        help_section="immediately_publish_comments_from">
<ul>
<li><label><input type="radio" name="moderate_comments" value="1"<mt:if name="moderate_comments_1"> checked="checked"</mt:if> class="rb" /> <__trans phrase="No one"></label></li>
<li><label><input type="radio" name="moderate_comments" value="2"<mt:if name="moderate_comments_2"> checked="checked"</mt:if> class="rb" /> <__trans phrase="Trusted commenters only"></label></li>
<li><label><input type="radio" name="moderate_comments" value="3"<mt:if name="moderate_comments_3"> checked="checked"</mt:if> class="rb" /> <__trans phrase="Any authenticated commenters"></label></li>
<li><label><input type="radio" name="moderate_comments" value="0"<mt:if name="moderate_comments_0"> checked="checked"</mt:if> class="rb" /> <__trans phrase="Anyone"></label></li>
</ul>
    </mtapp:setting>

    <mtapp:setting
        id="allow_comment_html"
        label="<__trans phrase="Allow HTML">"
        help_page="blog_settings_feedback"
        help_section="allow_html">
<input type="checkbox" name="allow_comment_html" id="allow_comment_html" onclick="toggleSubPrefs(this);" value="1"<mt:if name="allow_comment_html"> checked="checked"</mt:if> class="cb" /> <__trans phrase="If enabled, users will be able to enter a limited set of HTML in their comments. If not, all HTML will be stripped out.">
    </mtapp:setting>

    <div id="allow_comment_html_prefs" style="display: <mt:if name="allow_comment_html">block<mt:else>none</mt:if>;">
    <mtapp:setting
        id="sanitize_spec"
        label="<__trans phrase="Limit HTML Tags">"
        hint="<__trans phrase="Specifies the list of HTML tags allowed by default when cleaning an HTML string (a comment, for example).">"
        help_page="blog_settings_general"
        help_section="limit_html_tags">
<ul>
<li><label><input type="radio" name="sanitize_spec" id="sanitize_spec_0" value="0"<mt:if name="sanitize_spec_0"> checked="checked"</mt:if> class="rb" /> <__trans phrase="Use defaults">:</label> <span class="hint"><__trans phrase="([_1])" params="<mt:var name="global_sanitize_spec" escape="html">"></span></li>
<li><label><input type="radio" name="sanitize_spec" id="sanitize_spec_1" value="1"<mt:if name="sanitize_spec_1"> checked="checked"</mt:if> class="rb" /> <__trans phrase="Use my settings">:</label> <input name="sanitize_spec_manual" id="sanitize_spec_manual" value="<mt:if name="sanitize_spec_1"><mt:var name="sanitize_spec" escape="html"></mt:if>" /></li>
</ul>
    </mtapp:setting>

    <mtapp:setting
        id="nofollow_urls"
        label="<__trans phrase="Apply 'nofollow' to URLs">"
        help_page="blog_settings_feedback"
        help_section="nofollow_urls"
        show_warning="1"
        warning="<__trans phrase="This preference affects both comments and TrackBacks.">">
        <input type="checkbox" value="1" name="nofollow_urls" id="nofollow_urls"<mt:if name="nofollow_urls"> checked="checked"</mt:if> class="cb" onclick="toggleSubPrefs(this)" /> <label for="nofollow_urls"><__trans phrase="If enabled, all URLs in comments and TrackBacks will be assigned a 'nofollow' link relation."></label>
    </mtapp:setting>

    <div id="nofollow_urls_prefs" style="display: <mt:if name="nofollow_urls">block<mt:else>none</mt:if>;">

        <mtapp:setting
            id="follow_auth_links"
            label="<__trans phrase="Disable 'nofollow' for trusted commenters">"
            help_page="blog_settings_feedback"
            help_section="follow_auth_links">
            <input type="checkbox" value="1" name="follow_auth_links" id="follow_auth_links"<mt:if name="follow_auth_links"> checked="checked"</mt:if> class="cb" /> <label for="follow_auth_links"><__trans phrase="If enabled, the 'nofollow' link relation will not be applied to any comments left by trusted commenters."></label>
        </mtapp:setting>

    </div>

    </div>

    <mtapp:setting
        id="email_new_comments"
        label="<__trans phrase="E-mail Notification">"
        hint="<__trans phrase="Specify when Movable Type should notify you of new comments if at all.">"
        help_page="blog_settings_feedback"
        help_section="email_notification">
<ul>
<li><label><input type="radio" name="email_new_comments" value="1"<mt:if name="email_new_comments_1"> checked="checked"</mt:if> class="rb" /> <__trans phrase="On"></label></li>
<li><label><input type="radio" name="email_new_comments" value="2"<mt:if name="email_new_comments_2"> checked="checked"</mt:if> class="rb"  /> <__trans phrase="Only when attention is required"></label></li>
<li><label><input type="radio" name="email_new_comments" value="0"<mt:unless name="email_new_comments"> checked="checked"</mt:unless> class="rb" /> <__trans phrase="Off"></label></li>
</ul>
    </mtapp:setting>

<h3><__trans phrase="Display Options"></h3>

    <mtapp:setting
        id="sort_order_comments"
        label="<__trans phrase="Comment Order">"
        hint="<__trans phrase="Select whether you want visitor comments displayed in ascending (oldest at top) or descending (newest at top) order.">"
        help_page="blog_settings_general"
        help_section="comment_order">
<select name="sort_order_comments" id="sort_order_comments">
<option value="ascend"<mt:if name="sort_order_comments_ascend"> selected="selected"</mt:if>><__trans phrase="Ascending"></option>
<option value="descend"<mt:if name="sort_order_comments_descend"> selected="selected"</mt:if>><__trans phrase="Descending"></option>
</select>
    </mtapp:setting>

    <mtapp:setting
        id="autolink_urls"
        label="<__trans phrase="Auto-Link URLs">"
        help_page="blog_settings_feedback"
        help_section="autolink_urls">
<input type="checkbox" value="1" name="autolink_urls" id="autolink_urls"<mt:if name="autolink_urls"> checked="checked"</mt:if> class="cb" /> <__trans phrase="If enabled, all non-linked URLs will be transformed into links to that URL."> 
    </mtapp:setting>

    <mtapp:setting
        id="convert_paras_comments"
        label="<__trans phrase="Text Formatting">"
        hint="<__trans phrase="Specifies the Text Formatting option to use for formatting visitor comments.">"
        help_page="blog_settings_feedback"
        help_section="comment_text_formatting">
<select name="convert_paras_comments" id="convert_paras_comments">
<mt:loop name="text_filters_comments">
<option value="<mt:var name="key">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="label"></option>
</mt:loop>
</select>
    </mtapp:setting>

    <mtapp:setting
        id="capthca_provider"
        label="<__trans phrase="CAPTCHA Provider">">
        <mt:if name="captcha_loop">
            <select name="captcha_provider">
            <option value="none"><__trans phrase="Don't use CAPTCHA"></option>
            <mt:loop name="captcha_loop">
            <option value="<mt:var name="key">"<mt:if name="selected"> selected="selected"</mt:if>><mt:var name="label"></option>
            </mt:loop>
            </select>
        <mt:else>
            <p>
            <img src="<mt:var name="static_uri">images/status_icons/warning.gif" alt="<__trans phrase="No CAPTCHA provider available">" width="9" height="9" />
            <span class="alert-warning-inline"><__trans phrase="No CAPTCHA provider is available in this system.  Please check to see if Image::Magick is installed, and CaptchaImageSourceBase directive points to captcha-source directory under mt-static/images."></span>
            </p>
        </mt:if>
    </mtapp:setting>

    <mtapp:setting
        id="use_comment_confirmation"
        label="<__trans phrase="Use Comment Confirmation Page">">
<p><input type="checkbox" value="1" id="use_comment_confirmation" name="use_comment_confirmation"<mt:if name="use_comment_confirmation"> checked="checked"</mt:if> class="cb" /> <__trans phrase="Use comment confirmation page"></p>
    </mtapp:setting>

</div>


</fieldset>


<div style="text-align: center;">
<input type="submit" value="<__trans phrase="Save Changes">" title="<__trans phrase="Save changes (s)">" accesskey="s" />
</div>

</form>


<mt:include name="include/footer.tmpl">
