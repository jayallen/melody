<$mt:setvar name="screen_type" value="dialog-screen dialog-4"$>
<mt:include name="dialog/header.tmpl">

<script type="text/javascript" src="<mt:var name="static_uri">js/tc/client.js"></script>
<script type="text/javascript" src="<mt:var name="static_uri">js/tc/json.js"></script>
<script type="text/javascript" src="<mt:var name="static_uri">js/dialog.js"></script>

<script type="text/javascript">
<!--
var dialog;
var panels;
function dialog_closed(ok) {
    if (ok) {
        var frm = document['restore'];
        frm.submit();
    } else {
<mt:if name="is_dirty">
        var a = confirm('<__trans phrase="Canceling the process will create orphaned objects.  Are you sure you want to cancel the restore operation?">');
        if (!a) {
            return false;
        }
</mt:if>
        closeDialog('<mt:var name="script_url">?__mode=restore_premature_cancel&magic_token=<mt:var name="magic_token">&deferred_json=<mt:var name="deferred_json" escape="url">');
    }
}

function init() {
    dialog = new Dialog.MultiPanel("restore");
    panels = [];
    var panel;
    panel = new ListingPanel("<mt:var name="name">");
    panel.label = "<mt:var name="name">";
    panels[panels.length] = panel;
    dialog.setPanels(panels);
    dialog.open({}, dialog_closed);

    var next = TC.getElementsByTagAndClassName("input", "next", getByID('<mt:var name="name">-panel'));
    if (next) {
        this.nextButton = next[0];
        this.nextButton.onclick = function() {
            document['restore_form'].submit();
        };
    }
}

TC.attachLoadEvent(init);
//-->
</script>

<div id="<mt:var name="name">-panel" class="hidden panel">
  <h2><span class="weblog-title-highlight"><__trans phrase="Restore Multiple Files"></span>: <__trans phrase="Restoring"></h2>

<span class="modal_added"><__trans phrase="Please upload the following file">: <span class="upload_restore_files"><mt:var name="name"></span></span>

<mt:if name="error">
<mtapp:statusmsg
    id="generic-error"
    class="error">
    <mt:var name="error">
</mtapp:statusmsg>
</mt:if>
<form name="restore_form" id="restore_form" method="post" enctype="multipart/form-data" action="<mt:var name="script_url">">
<input type="hidden" name="__mode" value="dialog_restore_upload" />
<input type="hidden" name="magic_token" value="<mt:var name="magic_token">" />
<input type="hidden" name="files" value="<mt:var name="files">" />
<input type="hidden" name="assets" value="<mt:var name="assets" escape="html">" />
<input type="hidden" name="current_file" value="<mt:var name="name">" />
<input type="hidden" name="last" value="<mt:var name="last">" />
<input type="hidden" name="is_dirty" value="<mt:var name="is_dirty">" />
<input type="hidden" name="is_asset" value="<mt:var name="is_asset">" />
<input type="hidden" name="objects_json" value="<mt:var name="objects_json" escape="html">" />
<input type="hidden" name="deferred_json" value="<mt:var name="deferred_json" escape="html">" />

<p><label><__trans phrase="Upload">:</label>
<input name="file" id="file" type="file" size="50" /></p>
</form>
<div class="panel-commands">
    <form action="" method="get" onsubmit="return false" onclick="window.focus();">
        <input type="button" class="cancel" value="<__trans phrase="Cancel">" />
        <input type="button" class="next" value="<__trans phrase="Continue">" />
    </form>
</div>
</div>
<mt:include name="dialog/footer.tmpl">
